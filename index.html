<!DOCTYPE html>
<html lang="es">

<head>
    <!-- Configuraci√≥n b√°sica del documento HTML5 -->
    <meta charset="UTF-8">
    <!-- Para que se vea bien en m√≥viles - dise√±o responsive -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Enlazamos nuestro CSS para que el juego se vea bonito -->
    <link rel="stylesheet" type="text/css" media="screen" href="estilos/styles.css">
    <!-- Librer√≠a de confetti para animaci√≥n final -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    <!-- Cargamos el JavaScript principal como m√≥dulo ES6 - defer hace que se ejecute despu√©s de cargar el HTML -->
    <script type="module" src="main.js" defer></script>
    <title>Aventura-Reino</title>
</head>

<body>
    <div class="money-indicator" id="money-indicator">
        <img src="imagenes/monedero.png" alt="">
        <div>
            <span class="money-amount" id="money-display">500</span>
        </div>
    </div>

    <!-- Cabecera del juego - siempre visible arriba -->
    <header>
        <h1>Bienvenido a la Aventura del Reino</h1>
    </header>

    <!-- Contenedor principal donde est√°n todas las escenas del juego -->
    <main>
        <!-- ESCENA 1: Formulario de creaci√≥n del personaje -->
        <div id="scene1" class="scene active">
            <h2>Creaci√≥n de Personaje</h2>
            <div class="escena-container">
                <!-- Secci√≥n del jugador: avatar + campo para cambiar nombre -->
                <div class="jugador-section">
                    <div class="avatar-container">
                        <!-- Imagen del h√©roe que representa al jugador -->
                        <img src="imagenes/heroe.jpg" alt="Avatar">
                    </div>
                    <div class="nombre-container">
                        <label for="player-name">Nombre del jugador:</label>
                        <!-- Input editable: solo letras y espacios, primera may√∫scula, m√°x 20 caracteres -->
                        <input type="text" value="Aventurero" id="player-name" maxlength="20"
                            pattern="^[A-Z√Å√â√ç√ì√ö√ë][a-z√°√©√≠√≥√∫√±A-Z√Å√â√ç√ì√ö√ë\s]{0,19}$"
                            title="Solo letras y espacios, primera letra may√∫scula, m√°ximo 20 caracteres"
                            oninput="validarNombre(this)" required>
                    </div>
                </div>

                <!-- Grid de estad√≠sticas del jugador - se actualiza din√°micamente desde JS -->
                <!-- Sistema de puntos: 10 puntos para distribuir entre vida, ataque y defensa -->
                <div class="puntos-disponibles">
                    <span>Puntos para distribuir: </span>
                    <span id="puntos-restantes" class="puntos-valor">10</span>
                    <span> / 10</span>
                </div>
                <div class="stats-container">
                    <div class="stat-box">
                        <label>Puntos:</label>
                        <span id="puntos">0</span>
                    </div>
                    <div class="stat-box">
                        <label for="vida-input">Vida (+1 por punto):</label>
                        <input type="number" value="0" id="vida-input" min="0" max="110" class="stat-input" required>
                    </div>
                    <div class="stat-box">
                        <label for="ataque-input">Ataque:</label>
                        <input type="number" value="0" id="ataque-input" min="0" max="100" class="stat-input" required>
                    </div>
                    <div class="stat-box">
                        <label for="defensa-input">Defensa:</label>
                        <input type="number" value="0" id="defensa-input" min="0" max="100" class="stat-input" required>
                    </div>
                    <div class="stat-box">
                        <label>Dinero:</label>
                        <span id="dinero">500</span>
                    </div>
                </div>

                <button class="continuar-btn" onclick="showScene('scene2')">Crear Personaje</button>
            </div>
        </div>

        <!-- ESCENA 2: Tarjeta del jugador -->
        <div id="scene2" class="scene">
            <h2>Tu Personaje</h2>
            <div class="player-status">
                <div class="player-info-complete">
                    <div class="player-avatar-large">
                        <img src="imagenes/heroe.jpg" alt="Avatar" id="player-avatar-scene2">
                    </div>
                    <div class="player-details">
                        <h3 id="player-name-scene2">Jugador</h3>
                        <div class="stats-complete">
                            <div class="stat-complete">
                                <span class="stat-label">Puntos:</span>
                                <span class="stat-value" id="puntos-scene2">0</span>
                            </div>
                            <div class="stat-complete">
                                <span class="stat-label">Vida:</span>
                                <span class="stat-value" id="vida-scene2">100/100</span>
                            </div>
                            <div class="stat-complete">
                                <span class="stat-label">Ataque:</span>
                                <span class="stat-value" id="ataque-scene2">0</span>
                            </div>
                            <div class="stat-complete">
                                <span class="stat-label">Defensa:</span>
                                <span class="stat-value" id="defensa-scene2">0</span>
                            </div>
                            <div class="stat-complete">
                                <span class="stat-label">Dinero:</span>
                                <span class="stat-value" id="dinero-scene2">500</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <button class="continuar-btn" onclick="showScene('scene3')">Ir al Mercado</button>
        </div>

        <!-- ESCENA 3: Mercado -->
        <div id="scene3" class="scene">
            <div class="mercado-header">
                <p class="mercado-subtitle">En el mercado, encuentra la oferta de los equipos y la ayuda especializada
                    mientras en estos eventos.</p>
                <h2>MERCADO</h2>
            </div>

            <!-- Grid de productos que se llena din√°micamente desde JavaScript -->
            <!-- Muestra 9 productos aleatorios de los 24 disponibles -->
            <div class="productos-grid" id="productos-grid">
                <!-- Los productos se generar√°n din√°micamente -->
                <div class="cover">1</div>
            </div>

            <!-- Carrito de compras - muestra lo que el jugador ha seleccionado -->
            <div class="carrito-seleccion" id="carrito-seleccion">
                <h3>Productos Seleccionados:</h3>
                <!-- Lista din√°mica de productos seleccionados -->
                <div id="productos-seleccionados">Ning√∫n producto seleccionado</div>
                <!-- Precio total que se calcula autom√°ticamente -->
                <div class="total-carrito">Total: <span id="total-precio">0‚Ç¨</span></div>
                <!-- Dinero disponible (se actualiza seg√∫n lo a√±adido en la cesta) -->
                <div class="dinero-disponible">Dinero restante: <span id="dinero-mercado">500</span></div>
            </div>

            <div class="botones-mercado">
                <button class="comprar-btn" id="comprar-btn" disabled onclick="buyItems()">Confirmar Compra</button>
                <button class="continuar-btn" onclick="showScene('scene4')">Continuar</button>
            </div>
        </div>

        <!-- ESCENA 4: Tarjeta del jugador actualizada (post-mercado) -->
        <div id="scene4" class="scene">
            <h2>Estado Actual del Jugador</h2>
            <div class="player-status">
                <div class="player-info-complete">
                    <div class="player-avatar-large">
                        <img src="imagenes/heroe.jpg" alt="Avatar" id="player-avatar-scene4">
                    </div>
                    <div class="player-details">
                        <h3 id="player-name-scene4">Jugador</h3>
                        <div class="stats-complete">
                            <div class="stat-complete">
                                <span class="stat-label">Puntos:</span>
                                <span class="stat-value" id="puntos-scene4">0</span>
                            </div>
                            <div class="stat-complete">
                                <span class="stat-label">Vida:</span>
                                <span class="stat-value" id="vida-scene4">100/100</span>
                            </div>
                            <div class="stat-complete">
                                <span class="stat-label">Ataque Total:</span>
                                <span class="stat-value" id="ataque-scene4">0</span>
                            </div>
                            <div class="stat-complete">
                                <span class="stat-label">Defensa Total:</span>
                                <span class="stat-value" id="defensa-scene4">0</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="purchased-items">
                    <h3>Objetos Comprados:</h3>
                    <div id="items-comprados">No se han comprado objetos</div>
                </div>
            </div>
            <button class="continuar-btn" onclick="showScene('scene5')">Ver Enemigos</button>
        </div>

        <!-- ESCENA 5: Listado de enemigos -->
        <div id="scene5" class="scene">
            <h2>Enemigos del Reino</h2>
            <div class="enemies-grid" id="enemies-grid">
            </div>
            <button class="continuar-btn" onclick="showScene('scene6')">Comenzar Batallas</button>
        </div>

        <!-- ESCENA 6: Batallas autom√°ticas -->
        <div id="scene6" class="scene">
            <h2>Arena de Combate</h2>
            <div class="battle-arena">
                <div class="battle-info" id="battle-info">
                    <h3 id="battle-title">Prepar√°ndose para la batalla...</h3>
                    <div class="battle-participants">
                        <div class="participant player-side">
                            <div class="battle-image-container">
                                <img id="battle-player-image" src="imagenes/heroe.jpg" alt="Jugador">
                            </div>
                            <h4 id="battle-player-name">Jugador</h4>
                            <div class="participant-stats">
                                <span>ATQ: <span id="battle-player-attack">0</span></span>
                                <span>DEF: <span id="battle-player-defense">0</span></span>
                            </div>
                        </div>
                        <div class="vs-separator">VS</div>
                        <div class="participant enemy-side">
                            <div class="battle-image-container">
                                <img id="battle-enemy-image" src="" alt="Enemigo">
                            </div>
                            <h4 id="battle-enemy-name">Enemigo</h4>
                            <div class="participant-stats">
                                <span>ATQ: <span id="battle-enemy-attack">0</span></span>
                                <span>VIDA: <span id="battle-enemy-health">0</span></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="battle-result hidden" id="battle-result">
                    <h3 id="result-title">Resultado</h3>
                    <p id="result-description">...</p>
                    <p id="result-points">...</p>
                </div>
            </div>
            <div class="battle-controls">
                <button class="battle-btn" id="start-battle-btn" onclick="startBattle()">Iniciar Batalla</button>
                <button class="continuar-btn hidden" id="next-battle-btn" onclick="nextBattle()">Siguiente Batalla</button>
                <button class="continuar-btn hidden" id="finish-battles-btn" onclick="showScene('scene7')">Ver Resultado Final</button>
            </div>
        </div>

        <!-- ESCENA 7: Resultado final -->
        <div id="scene7" class="scene">
            <h2>¬°Aventura Completada!</h2>
            <div class="final-result">
                <div class="final-status" id="final-status">
                    <h3 id="final-classification">Clasificaci√≥n</h3>
                    <div class="final-points">
                        <span id="final-points-text">0 puntos</span>
                    </div>
                </div>

                <div class="ranking-container">
                    <h3>üìä Resumen Final</h3>
                    <table class="ranking-table">
                        <thead>
                            <tr>
                                <th>Estad√≠stica</th>
                                <th>Valor</th>
                            </tr>
                        </thead>
                        <tbody id="ranking-tbody">
                            <tr>
                                <td>üë§ Nombre</td>
                                <td id="rank-nombre">Jugador</td>
                            </tr>
                            <tr>
                                <td>‚≠ê Puntos Totales</td>
                                <td id="rank-puntos">0</td>
                            </tr>
                            <tr>
                                <td>üí∞ Dinero Final</td>
                                <td id="rank-dinero">0‚Ç¨</td>
                            </tr>
                            <tr>
                                <td>‚öîÔ∏è Batallas Ganadas</td>
                                <td id="rank-batallas">0/4</td>
                            </tr>
                            <tr>
                                <td>‚ù§Ô∏è Vida Final</td>
                                <td id="rank-vida">0</td>
                            </tr>
                            <tr>
                                <td>üó°Ô∏è Ataque Total</td>
                                <td id="rank-ataque">0</td>
                            </tr>
                            <tr>
                                <td>üõ°Ô∏è Defensa Total</td>
                                <td id="rank-defensa">0</td>
                            </tr>
                            <tr>
                                <td>üéí Objetos Comprados</td>
                                <td id="rank-objetos">0</td>
                            </tr>
                            <tr class="ranking-nivel">
                                <td>üèÜ Nivel Final</td>
                                <td id="rank-nivel">Rookie</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <button class="continuar-btn" onclick="showScene('scene8')">Ver Ranking</button>
        </div>

        <!-- ESCENA 8: Ranking (historial de jugadores) -->
        <div id="scene8" class="scene">
            <h2>üèÖ Ranking de Jugadores</h2>
            <div class="ranking-container historial-container">
                <h3>Tabla de Puntuaciones</h3>
                <div class="historial-table-wrapper">
                    <table class="ranking-table historial-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Nombre</th>
                                <th>Puntuaci√≥n</th>
                                <th>Monedas</th>
                            </tr>
                        </thead>
                        <tbody id="historial-tbody">
                        </tbody>
                    </table>
                </div>
            </div>
            <button class="restart-btn" onclick="restartGame()">Empezar Nueva Aventura</button>
        </div>
    </main>

    <!-- Footer fijo con el inventario visual - siempre visible -->
    <footer>
        <!-- 6 slots de inventario que se llenan conforme compras objetos -->
        <div id="inventario-contenedor">
            <!-- Cada slot muestra la imagen del tipo de objeto (arma/armadura/consumible) -->
            <div class="item"><img src="" alt="Slot vac√≠o"></div>
            <div class="item"><img src="" alt="Slot vac√≠o"></div>
            <div class="item"><img src="" alt="Slot vac√≠o"></div>
            <div class="item"><img src="" alt="Slot vac√≠o"></div>
            <div class="item"><img src="" alt="Slot vac√≠o"></div>
            <div class="item"><img src="" alt="Slot vac√≠o"></div>
        </div>
    </footer>

    <!-- Template HTML para generar productos din√°micamente -->
    <!-- No se muestra en pantalla, solo se usa como molde en JavaScript -->
    <template id="producto-template">
        <div class="producto-card" data-producto-id="">
            <img src="" alt="Producto">
            <h4 class="producto-nombre"></h4>
            <div class="producto-info">
                <!-- Precio original tachado -->
                <span class="precio-original"></span>
                <!-- Precio con descuento aplicado -->
                <span class="precio-descuento"></span>
            </div>
            <div class="producto-detalles">
                <!-- Tipo: arma/armadura/consumible -->
                <span class="categoria"></span>
                <!-- Rareza: Com√∫n/Raro/√âpico/Legendario -->
                <span class="rareza"></span>
            </div>
        </div>
    </template>

    <!-- Contenedor para las monedas cayendo -->
    <div class="falling-coins-container" id="falling-coins">
        <div class="falling-coin coin-1">
            <img src="imagenes/moneda.png" alt="Moneda">
        </div>
        <div class="falling-coin coin-2">
            <img src="imagenes/moneda.png" alt="Moneda">
        </div>
        <div class="falling-coin coin-3">
            <img src="imagenes/moneda.png" alt="Moneda">
        </div>
    </div>
</body>

</html>